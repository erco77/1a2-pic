// vim: autoindent tabstop=8 shiftwidth=4 expandtab softtabstop=4

   125 Hz Main Loop
   +---------------------------------+
   |                               A |
   |                                / \
   |                         ______/   \_____
   |                        /                \  yes
   |                       <   Line Detect?   >----------------+
   |                        \______     _____/               B | (Line in use)
   |                               \   /                      / \
   |                                \ / no             ______/   \_____
   |                                 |                /                \  yes
   |                               I | (Idle|Ring)   <       Hold?      >----------------------------+
   |                                / \               \______     _____/                           C |  (Currently on HOLD)
   |                         ______/   \_____                \   /                                  / \
   |                    yes /                \                \ / no                         ______/   \_____
   |           +-----------<       Ring?      >             ___|                            /                \  yes
   |           |            \______     _____/             |                               <      A Lead?     >-----------+
   |           |                   \   /                F / \ (Active Call)                 \______     _____/            |
   |           |                    \ / no         ______/   \_____                                \   /                  |
   |           |                     |            /                \ yes                            \ / no                |
   |           |                     |           <      A Lead?     >-----------+                    |                    |
   |           |                     |            \______     _____/            |                    |                    |
   |           |                     |                   \   /                  |                    |                    |
   |           |                     |                    \ / no                |                    |                    |
   |           |                     |                     |                    |                    |                    |
   |           |                     |                     |                    |                    |                    |
   |         J | (Ringing)         K | (Idle)            H |  (HOLD|Hangup)   G | (On Call)        E | (On HOLD)        D | (Pickup from HOLD)
   |          \|/                   \|/                   \|/                  \|/                  \|/                  \|/
   |      Line Ringing           Line Idle        HOLD after 1/20sec       Line In Use         Call On HOLD       Pickup From HOLD
   |   +-----------------+   +-----------------+  +-----------------+  +-----------------+  +-----------------+  +-----------------+  
   |   |  0 -> Hold State|   |  0 -> Hold State|  |  1 -> Hold State|  |  0 -> Hold State|  |  0 -> Hold State|  |  0 -> Hold State|
   |   +-----------------+   +-----------------+  +-----------------+  +-----------------+  +-----------------+  +-----------------+  
   |           |                     |                     |                    |                    |                    |
   |          \|/                   \|/                   \|/                  \|/                  \|/                  \|/
   |   +-----------------+   +-----------------+  +-----------------+  +-----------------+  +-----------------+  +-----------------+  
   |   |  0 -> Hold Rly  |   |  0 -> Hold Rly  |  |  1 -> Hold Rly  |  |  0 -> Hold Rly  |  |  1 -> Hold Rly  |  |  0 -> Hold Rly  |
   |   +-----------------+   +-----------------+  +-----------------+  +-----------------+  +-----------------+  +-----------------+  
   |           |                     |                     |                    |                    |                    |
   |          \|/                   \|/                   \|/                  \|/                  \|/                  \|/
   |   +-----------------+   +-----------------+  +-----------------+  +-----------------+  +-----------------+  +-----------------+  
   |   | RCAD -> Ring Rly|   |  0 -> Ring Rly  |  |  0 -> Ring Rly  |  |  0 -> Ring Rly  |  |  0 -> Ring Rly  |  |  0 -> Ring Rly  |
   |   +-----------------+   +-----------------+  +-----------------+  +-----------------+  +-----------------+  +-----------------+  
   |           |                     |                     |                    |                    |                    |
   |          \|/                   \|/                   \|/                  \|/                  \|/                  \|/
   |   +-----------------+   +-----------------+  +-----------------+  +-----------------+  +-----------------+  +-----------------+  
   |   | Ring -> Lamp    |   |  0 -> Lamp      |  | Hold -> Lamp    |  |  1 -> Lamp      |  |  Hold -> Lamp   |  |  1 -> Lamp      |
   |   +-----------------+   +-----------------+  +-----------------+  +-----------------+  +-----------------+  +-----------------+  
   |           |                     |                     |                    |                    |                    |
   |          \|/                   \|/                   \|/                  \|/                  \|/                  \|/
   |           |                     |                     |                    |                    |                    |
   +-----------o---------------------o---------------------o--------------------o--------------------o--------------------o

